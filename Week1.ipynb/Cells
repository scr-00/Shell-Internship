# Step 1: Import libraries
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Step 2: Load dataset
file_path = r"C:\Users\SRI LAKSHMI\Documents\Internship\Shell\Week1\waterquality.csv"   # change filename if needed
df = pd.read_csv(file_path)

# Step 3: Explore dataset
print("Dataset Info:")
print(df.info())

print("\nDataset Summary:")
print(df.describe())

print("\nMissing Values:")
print(df.isnull().sum())

# Step 4: Convert Date column to datetime and extract Year
df['Date'] = pd.to_datetime(df['Date'], errors='coerce')   # coerce handles bad formats
df['Year'] = df['Date'].dt.year

# Step 5: Group data by Year (1989 - 2025)
yearly_data = df.groupby('Year').mean(numeric_only=True).reset_index()

print("\nYearly Average Data (1989-2025):")
print(yearly_data.head())

# Step 6: Plot graphs
plt.figure(figsize=(12,6))
sns.lineplot(data=yearly_data, x="Year", y="DissolvedOxygen (mg/L)", marker="o", label="Dissolved Oxygen")
sns.lineplot(data=yearly_data, x="Year", y="Salinity (ppt)", marker="o", label="Salinity")
sns.lineplot(data=yearly_data, x="Year", y="pH", marker="o", label="pH")

plt.title("Water Quality Parameters Over the Years (1989 - 2025)")
plt.xlabel("Year")
plt.ylabel("Average Values")
plt.legend()
plt.grid(True)
plt.show()

# Extra: Compare Water vs Air Temperature
plt.figure(figsize=(12,6))
sns.lineplot(data=yearly_data, x="Year", y="WaterTemp (C)", marker="o", label="Water Temp")
sns.lineplot(data=yearly_data, x="Year", y="AirTemp (C)", marker="o", label="Air Temp")
plt.title("Water vs Air Temperature Over the Years")
plt.xlabel("Year")
plt.ylabel("Average Temperature (Â°C)")
plt.legend()
plt.grid(True)
plt.show()
