# Step 1: Import libraries
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Step 2: Load the dataset
file_path = r"C:\Users\SRI LAKSHMI\Documents\Internship\Shell\Week1\waterquality.csv"
df = pd.read_csv(file_path)

# Step 3: Explore dataset
print("Dataset Info:")
print(df.info())
print("\nSummary Statistics:")
print(df.describe())
print("\nMissing Values:")
print(df.isnull().sum())

# Step 4: Convert Date column to datetime & extract Year
df['Date'] = pd.to_datetime(df['Date'], errors='coerce')  # convert to datetime
df['Year'] = df['Date'].dt.year   # create a Year column

# Step 5: Group data by Year
yearly_data = df.groupby('Year').mean(numeric_only=True)

print("\nYearly Averages:")
print(yearly_data.head())

# Step 6: Plot graphs (Trends over Years)
plt.figure(figsize=(12,6))
sns.lineplot(x=yearly_data.index, y=yearly_data['Salinity (ppt)'], label="Salinity (ppt)")
sns.lineplot(x=yearly_data.index, y=yearly_data['DissolvedOxygen (mg/L)'], label="Dissolved Oxygen (mg/L)")
sns.lineplot(x=yearly_data.index, y=yearly_data['pH'], label="pH")
plt.title("Water Quality Trends (1989 - 2019)")
plt.xlabel("Year")
plt.ylabel("Value")
plt.legend()
plt.show()

# Extra: Temperature trends
plt.figure(figsize=(12,6))
sns.lineplot(x=yearly_data.index, y=yearly_data['WaterTemp (C)'], label="Water Temperature (°C)")
sns.lineplot(x=yearly_data.index, y=yearly_data['AirTemp (C)'], label="Air Temperature (°C)")
plt.title("Temperature Trends (1989 - 2019)")
plt.xlabel("Year")
plt.ylabel("Temperature (°C)")
plt.legend()
plt.show()
